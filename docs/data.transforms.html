---

title: Helper functions for processing data and basic transforms
keywords: fastai
sidebar: home_sidebar

summary: "Functions for getting, splitting, and labeling data, as well as generic transforms"
---
<!--


#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: dev/06_data_transforms.ipynb
# instructions: https://docs.fast.ai/gen_doc_main.html

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">local.notebook.showdoc</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get,-split,-and-label">Get, split, and label<a class="anchor-link" href="#Get,-split,-and-label">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For most data source creation we need functions to get a list of items, split them in to train/valid sets, and label them. fastai provides functions to make each of these steps easy (especially when combined with <code>fastai.data.blocks</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get">Get<a class="anchor-link" href="#Get">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll look at functions that <em>get</em> a list of items (generally file names).</p>
<p>We'll use <em>tiny MNIST</em> (a subset of MNIST with just two classes, <code>7</code>s and <code>3</code>s) for our examples/tests throughout this page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [/home/sgugger/.fastai/data/mnist_tiny/train/3,/home/sgugger/.fastai/data/mnist_tiny/train/7]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_files" class="doc_header"><code>get_files</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>path</code></strong>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get all the files in <code>path</code> with optional <code>extensions</code>, optionally with <code>recurse</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the most general way to grab a bunch of file names from disk. If you pass <code>extensions</code> (including the <code>.</code>) then returned file names are filtered by that list. Only those files directly in <code>path</code> are included, unless you pass <code>recurse</code>, in which case all child folders are also searched recursively. <code>folders</code> is an optional list of directories to limit the search to.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t7</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#709) [/home/sgugger/.fastai/data/mnist_tiny/train/3/8055.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/9466.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/7778.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/8824.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/8228.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/9620.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/8790.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/7497.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/7383.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/9324.png...]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's often useful to be able to create functions with customized behavior. <code>fastai.data</code> generally uses functions named as CamelCase verbs ending in <code>er</code> to create these functions. <a href="/data.transforms.html#FileGetter"><code>FileGetter</code></a> is a simple example of such a function creator.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileGetter" class="doc_header"><code>FileGetter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms.html#get_files"><code>get_files</code></a> partial function that searches path suffix <code>suf</code>, only in <code>folders</code>, if specified, and passes along args</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fpng</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">fpng_r</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng_r</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image_files" class="doc_header"><code>get_image_files</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get image files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simply <a href="/data.transforms.html#get_files"><code>get_files</code></a> called with a list of standard image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageGetter" class="doc_header"><code>ImageGetter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms.html#get_image_files"><code>get_image_files</code></a> partial function that searches path suffix <code>suf</code> and passes along <code>kwargs</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as <a href="/data.transforms.html#FileGetter"><code>FileGetter</code></a>, but for image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">ImageGetter</span><span class="p">(</span>   <span class="s1">&#39;train&#39;</span><span class="p">,</span>                    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)(</span><span class="n">path</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split">Split<a class="anchor-link" href="#Split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next set of functions are used to <em>split</em> data into training and validation sets. The functions return two lists - a list of indices or masks for each of training and validation sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSplitter" class="doc_header"><code>RandomSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Create function that splits <code>items</code> between train/val with <code>valid_pct</code> randomly.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="IndexSplitter" class="doc_header"><code>IndexSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>IndexSplitter</code>(<strong><code>valid_idx</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> so that <code>val_idx</code> are in the validation set and the others in the training set</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">IndexSplitter</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GrandparentSplitter" class="doc_header"><code>GrandparentSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train_name</code></strong>=<em><code>'train'</code></em>, <strong><code>valid_name</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> from the grand parent folder names (<code>train_name</code> and <code>valid_name</code>).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/9932.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7189.png&#39;</span><span class="p">,</span> 
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7320.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/9833.png&#39;</span><span class="p">,</span>  
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/7666.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/925.png&#39;</span><span class="p">,</span>
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/724.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/93055.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FuncSplitter" class="doc_header"><code>FuncSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FuncSplitter</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> by result of <code>func</code> (<code>True</code> for validation, <code>False</code> for training set).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">FuncSplitter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MaskSplitter" class="doc_header"><code>MaskSplitter</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L98" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MaskSplitter</code>(<strong><code>mask</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> depending on the value of <code>mask</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">MaskSplitter</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Label">Label<a class="anchor-link" href="#Label">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final set of functions is used to <em>label</em> a single item of data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parent_label" class="doc_header"><code>parent_label</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L105" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parent_label</code>(<strong><code>o</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with the parent folder name.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="/data.transforms.html#parent_label"><code>parent_label</code></a> doesn't have anything customize, so it doesn't return a function - you can just use it directly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="s2">&quot;fastai_dev/dev/data/mnist_tiny/train/3/9932.png&quot;</span><span class="p">),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">parent_label</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegexLabeller" class="doc_header"><code>class</code> <code>RegexLabeller</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L110" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegexLabeller</code>(<strong><code>pat</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with regex <code>pat</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.transforms.html#RegexLabeller"><code>RegexLabeller</code></a> is a very flexible function since it handles any regex search of the stringified item. For instance, here's an example the replicates the previous <a href="/data.transforms.html#parent_label"><code>parent_label</code></a> results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{re.escape(os.path.sep)}(\d){re.escape(os.path.sep)}&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="n">regexp</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ColReader" class="doc_header"><code>class</code> <code>ColReader</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L120" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ColReader</code>(<strong><code>cols</code></strong>, <strong><code>pref</code></strong>=<em><code>''</code></em>, <strong><code>suff</code></strong>=<em><code>''</code></em>, <strong><code>label_delim</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Read <code>cols</code> in <code>row</code> with potnetial <code>pref</code> and <code>suff</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>cols</code> can be a list of column names or a list of indices (or a mix of both). If <code>label_delim</code> is passed, the result is split using it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;a b c d&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1 2&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;1 2 3&#39;</span><span class="p">]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="s1">&#39;0a1 0b1 0c1 0d1&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label_delim</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]])</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">],</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[(</span><span class="s1">&#39;0a1&#39;</span><span class="p">,</span> <span class="s1">&#39;0a1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0b1&#39;</span><span class="p">,</span> <span class="s1">&#39;0b1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0c1&#39;</span><span class="p">,</span> <span class="s1">&#39;0c1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0d1&#39;</span><span class="p">,</span> <span class="s1">&#39;0d1&#39;</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoryMap" class="doc_header"><code>class</code> <code>CategoryMap</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L134" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoryMap</code>(<strong><code>col</code></strong>, <strong><code>sort</code></strong>=<em><code>True</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/core.foundation.html#CollBase"><code>CollBase</code></a></p>
</blockquote>
<p>Collection of categories with the reverse mapping in <code>o2i</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_fail</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unseen label&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;#na#&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Categorize" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L148" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/core.transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Reversible transform of category string to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Category" class="doc_header"><code>class</code> <code>Category</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L163" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Category</code>() :: <code>str</code></p>
</blockquote>
<p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategorize" class="doc_header"><code>class</code> <code>MultiCategorize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L166" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Reversible transform of multi-category strings to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategory" class="doc_header"><code>class</code> <code>MultiCategory</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L184" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategory</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <a href="/core.foundation.html#L"><code>L</code></a></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">MultiCategorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([]),</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OneHotEncode" class="doc_header"><code>class</code> <code>OneHotEncode</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L189" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OneHotEncode</code>(<strong><code>c</code></strong>=<em><code>None</code></em>) :: <a href="/core.transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>One-hot encodes targets</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Works in conjunction with <code>MultiCategorize</code> or on its own if you have one-hot encoded targets (pass a <code>vocab</code> for decoding and <code>do_encode=False</code> in this case)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">OneHotEncode</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="p">[[</span><span class="n">MultiCategorize</span><span class="p">(),</span> <span class="n">OneHotEncode</span><span class="p">()]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])]),</span> <span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorMultiCategory</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EncodedMultiCategorize" class="doc_header"><code>class</code> <code>EncodedMultiCategorize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L202" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EncodedMultiCategorize</code>(<strong><code>vocab</code></strong>) :: <a href="/data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Transform of one-hot encoded multi-category that decodes with <code>vocab</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">EncodedMultiCategorize</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_c" class="doc_header"><code>get_c</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L210" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_c</code>(<strong><code>dbunch</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-to-end-dataset-example-with-MNIST">End-to-end dataset example with MNIST<a class="anchor-link" href="#End-to-end-dataset-example-with-MNIST">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's show how to use those functions to grab the mnist dataset in a <a href="/data.core.html#DataSource"><code>DataSource</code></a>. First we grab all the images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we split between train and validation depending on the folder.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">)</span>
<span class="n">train</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">valid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#3) [/home/sgugger/.fastai/data/mnist_tiny/train/3/8055.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/9466.png,/home/sgugger/.fastai/data/mnist_tiny/train/3/7778.png],
 (#3) [/home/sgugger/.fastai/data/mnist_tiny/valid/3/957.png,/home/sgugger/.fastai/data/mnist_tiny/valid/3/9073.png,/home/sgugger/.fastai/data/mnist_tiny/valid/3/8939.png])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our inputs are images that we open and convert to tensors, our targets are labeled depending on the parent directory and are categories.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="k">def</span> <span class="nf">open_img</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span><span class="n">Path</span><span class="p">):</span> <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img2tensor</span><span class="p">(</span><span class="n">im</span><span class="p">:</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span> <span class="k">return</span> <span class="n">TensorImage</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">open_img</span><span class="p">,</span> <span class="n">img2tensor</span><span class="p">],</span>
        <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">decode_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">yd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">xd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">show_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAEeUlEQVR4nO3bX4iNeRzH8dfPUNQQZUZpUDY1tWVTwlJMLuzFElLaDRfKjVwgN1yIGtSUq73YG4mylCxJoVxoL5a4WDdM1rZhS4iQKeTPevZi9pkz85vDnDHnzHPW/t51Ouc5v/M8z7fP+Tzf3+/3/T1PyLJMosSIogOoN5IgEUmQiCRIRBIkIgkSkQSJKFyQEMJPIYQHIYSuEMIfIYQNhcZT9MAshPAl/syy7HUIoRW/4Nssy34rIp7CHZJlWWeWZa/zzX9fXxQVT+GCQAjhxxDCS/yOBzhXWCxFXzI5IYQGfI02dGRZ9raIOOrCIZBl2d9Zlv2KFmwsKo66EaQXI/1fc0gIoTmE8F0IoTGE0BBC+Abf42JhMRWZQ0IITfgZX+n+c/7CD1mWHSgspnpJqvVCPeaQQkmCRCRBIpIgESMHaP+cM24o92VySEQSJCIJEpEEiUiCRCRBIpIgEQONQ4aNFy9egIMHD4LNmzeD1atXg2PHjoGGhoaaxpEcEjHQ9L+mI9VLly6BV69e6ejoABcvlq8NdXZ2gtbW1mqdPo1UK2FYc8jjx4/BkSNHwI4dO8C7d+8G3PfGjRuoqkPKkhwSMSw55OjRo2DXrl3gzp07fdonTJjQ8/nZs2d92qZNmwZu3boFRo0aVY2QSDmkMoYlhzx58gT9nbF+/XqwdetW27dvB+fO9V3F3LZtG6rqjI+SHBIxLA7ZtGkTuH79Oli2bBlYsmQJaG9v7+eMsWPHgqVLlw5HiD0kh0QUMlK9ffs22LdvHzh06FBP2/jx48G1a9dQ6mVqQOplKqEQhzQ2NqJ7DhOTz2UWLVpUi1P3JjmkEgpxyJgxY8CbN2/6tU2cOBFs3Nh9z8zixYvBggULUNV6SHJIJdSdQz7EnDlzwP79+0FLSwuG1AuVdUghgty8eROcPn0aLF++vKft8OHD4OrVq332uXfvHrh79y5YsWIFOHny5KeGkS6ZSii0hDgYnj59Ctra2lCaMOZOyi+hQZAcUgk1cUh+zPx9xIjq6Z47Yv78+dBTNti7d+9gD5UcUglVnf6fOXMG3L9/H6xcuRJMmjSpauc4e/Zsn+0LFy7gkxxSluSQiKrmkNmzZ4OmpiZw/vz5T42rHw8fPgSzZs0Cjx49ApcvXwZz584d7CFTDqmEquSQK1euoLTcmI8VhsL79+/B7t27wYED3Xd7587I89LkyZOHfK7eJIdEVMUhM2fOBFOnTkXJMevWrQM7d+7s8/sZM2agNC95+7b0rFC+zJkf40OL32vXrgVTpkwZcvy9SQ6JqGovs2rVKpRmsR9izZo14NSpUyhfSozJC0fHjx8H8+bNA6NHjx5MiL1JvUwlVNUhXV1dKN3+1N7eDp4/f47KnJDPe5qbm1Fy3ZYtW8D06dMHE9LHSA6phGGph+Q3u+zZswecOHECLFy4EGzYUHq6fdy4cSgtd9aQ5JBK+M9UzGpAckglJEEikiARSZCIJEhEEiQiCRIxUD2kbF/9OZMcEpEEiUiCRCRBIpIgEUmQiH8AXEReOybNeDQAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToTensor" class="doc_header"><code>class</code> <code>ToTensor</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L217" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToTensor</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>False</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <a href="/core.transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Convert item to appropriate tensor class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Cuda" class="doc_header"><code>class</code> <code>Cuda</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L223" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Cuda</code>(<strong><code>device</code></strong>=<em><code>None</code></em>) :: <a href="/core.transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Move batch to <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a> (defaults to <code>default_device()</code>)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Cuda.encodes" class="doc_header"><code>Cuda.encodes</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L228" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.encodes</code>()</p>
</blockquote>
<p>Move batch to <a href="https://pytorch.org/docs/stable/tensor_attributes.html#torch-device"><code>device</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that, like all <a href="/core.transform.html#Transform"><code>Transform</code></a>s, <a href="/tabular.rapids.html#encodes"><code>encodes</code></a> is called by <code>tfm()</code> and <a href="/vision.core.html#decodes"><code>decodes</code></a> is called by <code>tfm.decode()</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">Cuda</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">((</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">),))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.cuda.LongTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Cuda.decodes" class="doc_header"><code>Cuda.decodes</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L229" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.decodes</code>()</p>
</blockquote>
<p>Return batch to CPU</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span> 
    <span class="k">def</span> <span class="nf">encodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> 
    <span class="k">def</span> <span class="nf">decodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">Int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 
    
<span class="n">start</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">()])</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">Cuda</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tdl</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">default_device</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IntToFloatTensor" class="doc_header"><code>class</code> <code>IntToFloatTensor</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L234" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IntToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>255.0</code></em>, <strong><code>div_mask</code></strong>=<em><code>1</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>True</code></em>) :: <a href="/core.transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">TensorImage</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">(),</span><span class="n">TensorMask</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">IntToFloatTensor</span><span class="p">(</span><span class="n">as_item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">TensorMask</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="broadcast_vec" class="doc_header"><code>broadcast_vec</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L246" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>broadcast_vec</code>(<strong><code>dim</code></strong>, <strong><code>ndim</code></strong>, <strong>*<code>t</code></strong>, <strong><code>cuda</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Make a vector broadcastable over <code>dim</code> (out of <code>ndim</code> total) by prepending and appending unit axes</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalize" class="doc_header"><code>class</code> <code>Normalize</code><a href="https://github.com/fastai/fastai_dev/tree/master/dev/local/data/transforms.py#L255" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalize</code>(<strong><code>mean</code></strong>, <strong><code>std</code></strong>, <strong><code>dim</code></strong>=<em><code>1</code></em>, <strong><code>ndim</code></strong>=<em><code>4</code></em>, <strong><code>cuda</code></strong>=<em><code>True</code></em>) :: <a href="/core.transform.html#Transform"><code>Transform</code></a></p>
</blockquote>
<p>Normalize/denorm batch of <a href="/torchcore.html#TensorImage"><code>TensorImage</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="n">broadcast_vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Cuda</span><span class="p">(),</span> <span class="n">IntToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)]</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">after_batch</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.cuda.FloatTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">xd</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mi">1</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Just for visuals</span>
<span class="kn">from</span> <span class="nn">local.vision.core</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAHC0lEQVR4nO3du4tV3R3H4bW8YGFAFJMpDE5hYSCC2hlQvBSOEBhshKTVIETRxtu/YLAb8C3GwlHSmamENEIIOpZBLAJj0AFFebERtIho0J0iFwjMWSfO5T3fc+Z5wML5sd2r+cweXa6za9d1BcizbtALABYnTgglTgglTgglTgglTgglTgglzhFRa/19rfX7WuuHWuvfaq2/GfSaWJ7qPyGMhlrrz0spz7uu+1Rr/Vkp5c+llF92XfeXwa6MpfLkHBFd1/2167pP//ntv3/tGuCSWCZxjpBa63e11r+XUuZLKd+XUv444CWxDH6sHTG11vWllF+UUo6UUn7Xdd0/BrsilsqTc8R0Xfel67q5UspPSym/HfR6WDpxjq4Nxd85h5o4R0Ct9Se11l/VWn9Ua11fa50opfy6lPKnQa+NpfN3zhFQa/1xKeUPpZS95V/fcF+WUqa6rrs10IWxLOKEUH6shVDihFDihFDihFAbWsNaq38tglXWdV1d7OuenBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBCq+QrAUTU2Ntac37t3rzk/dOhQcz49Pd2cb9++vefs/v37zWv7mZmZWdb15PDkhFDihFDihFDihFDihFDihFDihFC167rew1p7D4fYkSNHmvMHDx405+vWtb+nff369VuXtGLm5uaa8+vXrzfn8/PzPWevX79uXvvly5fmnMV1XVcX+7onJ4QSJ4QSJ4QSJ4QSJ4QSJ4QSJ4Rak/uc4+Pjzfns7Gxzvn///uZ8kPucq7kHe+nSpeZ8ampqyX/2WmafE4aMOCGUOCGUOCGUOCGUOCHUmtxK6Wfbtm3Neb+Pzty7d29zvmXLlm9e0/9rNbdSPn361Jy/ffu2OT9z5kxz/uTJk56z9+/fN68dZrZSYMiIE0KJE0KJE0KJE0KJE0KJE0LZ51wFExMTzfnZs2d7ziYnJ5d17+SP7ey3tqNHj/acPXz4cKWXE8M+JwwZcUIocUIocUIocUIocUIocUIo+5wj5uDBg8356dOnm/N9+/b1nPU7p9pPv33OhYWFnrNdu3Yt697J7HPCkBEnhBInhBInhBInhBInhBInhLLPucaMjY0159euXes5u3DhwrLu3W+f8+PHjz1n58+fb157586dJa0pgX1OGDLihFDihFDihFDihFDihFDihFAbBr0AVlbrPGYppczOzjbnO3fuXMnlfJNNmzb1nI2Pj/+AK8ngyQmhxAmhxAmhxAmhxAmhxAmhHBkLc+DAgeb83LlzzfmJEyea861bt37zmlZKvyNjr1696jnr97GcHz58WNKaEjgyBkNGnBBKnBBKnBBKnBBKnBBKnBDKkbEBOHnyZM/ZzMxM89rNmzc35/32Er9+/dqcD9L09HTP2TDvYy6VJyeEEieEEieEEieEEieEEieEEieEcp5zFfT7GMeFhYVVu/cg9znn5uaa88OHD6/avYeZ85wwZMQJocQJocQJocQJocQJocQJoZznHIBBnqn8/Plzc/7mzZuesytXrjSvffz48ZLWxOI8OSGUOCGUOCGUOCGUOCGUOCGUOCGUfc415ubNm8355cuXf6CV0I8nJ4QSJ4QSJ4QSJ4QSJ4QSJ4SylbIKXr9+3ZxPTU31nF28eHGll/M/Xr161Zy3Ptbz5cuXK70cGjw5IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZRXAA7Avn37es5OnTrVvPbq1avN+XJfAfj06dOes+PHjzevfffuXXPO4rwCEIaMOCGUOCGUOCGUOCGUOCGUOCHU0J7nbJ07LKWUhYWFnrN+r7Ib5H5drYtuef1Xv33MfvN+9u/f33P26NGj5rWTk5PN+YsXL5a0prXKkxNCiRNCiRNCiRNCiRNCiRNCiRNCDe15zn77nM+fP1+1ey/3zORqGuTanj171pzv2bNn1e49zJznhCEjTgglTgglTgglTgglTgg1tEfGyLN79+5BL2GkeHJCKHFCKHFCKHFCKHFCKHFCKHFCqKE9MrZ+/frmfMeOHT1nt27dal577Nix5tyRsaXZuHHjwO6dzJExGDLihFDihFDihFDihFDihFDihFBDu8+5HGNjY835xMREc3779u3mfFT3Oefn55vzGzduNOd3795d8r1HmX1OGDLihFDihFDihFDihFDihFDihFBrcp8TktjnhCEjTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgjVfAUgMDienBBKnBBKnBBKnBBKnBBKnBDqn6UCbXpskcm1AAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAHAElEQVR4nO3dPYjU2x3H4XO8W7hqJSYopJE0alwjK4giSBRBIaCFLyR9QANiYWdnG1ZBgtgIFpLO1cIijRAFg51Whg1LYHerayGrqESuQf8p8gIhO2dwRp3vLM8Dt7j+ODOH6/14Vo//2dp1XQHyrBn1BoCViRNCiRNCiRNCiRNCiRNCiRNCiXOVqLX+odb6fa31Ta11vtb6m1HvieFUfwlhdai1/qyU8reu636otW4rpTwqpfyy67qno90Zg3JyrhJd1/2l67of/vOv//7npyPcEkMS5ypSa71Ra/17KeWvpZTvSyl/HPGWGIIva1eZWut3pZT9pZRflFJ+13XdP0a7Iwbl5Fxluq772HXdn0spPyml/HbU+2Fw4ly9Jorfc441ca4CtdYf11p/VWvdUGv9rtZ6tJTy61LKn0a9Nwbn95yrQK31R6WU2VLKz8u/fsFdKqX8vuu6myPdGEMRJ4TyZS2EEieEEieEEieEmmgNa63+tAi+sq7r6ko/7uSEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUBOj3sCgJibaWz937lzP2bFjx5pr161b15wfPny4OYcvwckJocQJocQJocQJocQJocQJocQJocb2nnPHjh3N+bVr1wZ+7du3bzfnu3btGvi10719+7bnbGFh4RvuBCcnhBInhBInhBInhBInhBInhKpd1/Ue1tp7OGL9rjOePXv21d671tqct/6bfm3D7m15ebnnbO/evc21i4uLzTkr67puxZ80JyeEEieEEieEEieEEieEEieEEieEGttHxubn55vz3bt395zt3LmzubbfR2fu2bOnOd++fXtznmzjxo09Zxs2bPiGO8HJCaHECaHECaHECaHECaHECaHECaHG9nnOUep33zc5OfmNdvL/Xrx40Zz3e55zaWmp5+zAgQNDvTcr8zwnjBlxQihxQihxQihxQihxQihxQqixfZ5zlN69ezfUvGXt2rXN+d27d5vzNWvav95++PChOb9x40bPmXvMb8vJCaHECaHECaHECaHECaHECaHECaHcc4Y5ffp0c3706NHm/NOnT835zMxMc3716tXmnG/HyQmhxAmhxAmhxAmhxAmhxAmhXKWEOXny5FDrX7161Zxfv359qNfn23FyQihxQihxQihxQihxQihxQihxQij3nCOwf//+nrMjR44M9doXL15szn285fhwckIocUIocUIocUIocUIocUIocUKo2nVd72GtvYcM7N69ez1nx48fH+q1JyZcXY+bruvqSj/u5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQLsVG4OnTpz1nJ06cGOq1+32Lv9a9diml3L17t+dsbm6uufbNmzfNOZ/HyQmhxAmhxAmhxAmhxAmhxAmhxAmhPM85Aps3b+45u3//fnPt9PR0c17rio8G/le/e86WhYWF5vzJkyfN+ePHj5vz2dnZnrPXr183144zz3PCmBEnhBInhBInhBInhBInhHKVEqZ1zVJKKVNTU835pUuXmvODBw9+9p6+lH7XPA8fPuw5O3PmTHPt8vLyQHtK4CoFxow4IZQ4IZQ4IZQ4IZQ4IZQ4IZR7zlWm37cA3LZtW3O+devWnrOTJ0821546dao5n5ycbM5b/y8+evRoqPdOfuTMPSeMGXFCKHFCKHFCKHFCKHFCKHFCKPecfDGbNm1qzi9fvtycnzt3buD33r17d3P+/PnzgV/7a3PPCWNGnBBKnBBKnBBKnBBKnBBKnBCq/fAffIZ+n0u7d+/egdd/+PChufbjx4/N+ThyckIocUIocUIocUIocUIocUIoVyn8j9ZHY+7bt6+59ubNm815v4/GfP/+fc/ZhQsXmmvn5uaa83Hk5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQ7jnDbNmypTmfmppqztevX9+cnz17tjmfnp7uOdu4cWNzbT/z8/PN+czMTM/ZrVu3hnrvceTkhFDihFDihFDihFDihFDihFDihFC+BWCYBw8eNOeHDh1qzvt9PGXr53tYs7Ozzfn58+eb85cvX37J7YwN3wIQxow4IZQ4IZQ4IZQ4IZQ4IZQ4IZTnOcMsLi4Otf7KlStDrV9aWuo5u3PnTnNtv3vKr3nHuho5OSGUOCGUOCGUOCGUOCGUOCGUOCGU5zlhxDzPCWNGnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBCq+dGYwOg4OSGUOCGUOCGUOCGUOCGUOCHUPwHAx0t3DlZJ7gAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAH5klEQVR4nO3dT4hd5R3G8feNEVyMfyJMJ4vipqLFLIJIEgsJlATsooi4CLYqohCQCi5EUMSFiAvJxkXBioQslOJC60KEZmNiIIMLISjIaKhRKYoOIhGHUJHYnC5ahcDc39WZJve5N58PuDAPZ+ag+c5J8mbu7cMwNCDPhknfALA6cUIocUIocUIocUIocUIocUIocc6I3vtfe+9f9N5Xeu//6L3vm/Q9sT7dX0KYDb33La21k8MwfNd7/3Vr7Whr7ffDMByf7J2xVp6cM2IYhqVhGL774V//98+vJnhLrJM4Z0jv/S+993+11k601r5orf19wrfEOvhl7YzpvV/SWvtNa+23rbX9wzCcmewdsVaenDNmGIZ/D8Ow2Fr7ZWvtT5O+H9ZOnLNrY/N7zqkmzhnQe/9F7/0Pvfe53vslvffftdb+2Fo7Mul7Y+38nnMG9N7nW2t/a61tbf/9gvvP1tqfh2E4MNEbY13ECaH8shZCiRNCiRNCiRNCbazG3rs/LYLzbBiGvtqPe3JCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCqPItAGfVnj17yn3Xrl3lvnPnznLfvXv3z76nH/S+6rvB/WgY1veujIcOHSr3t956a+T28ssvl9d+9NFH5X727Nly51yenBBKnBBKnBBKnBBKnBBKnBBKnBCqV+dmvff1HapN0D333DNyO3DgQHnthg3116x33nmn3I8cOVLu77777sht3Dnn1q1by32czZs3l/stt9wycltYWCivPXz4cLnfeeed5f7VV1+V+6wahmHV/+menBBKnBBKnBBKnBBKnBBKnBBKnBBqas855+fny/39999f09Zaa48//ni5Ly4ulvs0u+KKK0Zue/fuLa99+OGHy/3bb78t95tuuqncZ5VzTpgy4oRQ4oRQ4oRQ4oRQ4oRQU/vSmONe3rJy++23l/upU6fW/LGn3crKysjt4MGD5bUff/xxub/xxhvlfuONN47cxn2b3izy5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQU3vOefTo0XJ/5plnRm4X8znm+XTs2LFy//rrr8v9mmuuGbk55wRiiBNCiRNCiRNCiRNCiRNCiRNCTe055/Lycrk//fTTF+hO+MH9999f7ps2bSr3Dz/88P95O1PPkxNCiRNCiRNCiRNCiRNCiRNCiRNCTe05JxfeI488Uu5PPvlkub/22mvlPu6tGS82npwQSpwQSpwQSpwQSpwQSpwQSpwQyjnnRaZ6D8zWWnvxxRdHbtddd1157XPPPVfujz76aLlzLk9OCCVOCCVOCCVOCCVOCCVOCOUoZRW993K/+uqry33Lli3lfu21147ctm/fXl67sLBQ7nv27Cn3ubm5cl9aWhq53X333eW1r7zySrnz83hyQihxQihxQihxQihxQihxQihxQijnnKsYd4755ZdfnrfPPe6MdRiGdX38cdd///33I7fPPvusvPbSSy8t9zNnzpQ75/LkhFDihFDihFDihFDihFDihFDihFC9Ovfqva/vUG1KXXbZZeX+4IMPnrfP/fbbb5f76dOny3337t3lPu77Qe+9996R26ZNm8prP/nkk3J/6qmnyv2FF14o91k1DMOqh9uenBBKnBBKnBBKnBBKnBBKnBBKnBDKOSfnuPzyy0dut912W3nts88+W+7jXjN3eXl55HbHHXeU1y4uLpZ7MuecMGXECaHECaHECaHECaHECaHECaGcc3LBPPbYY+X+xBNPjNxOnTpVXnvrrbeW+/Hjx8t9kpxzwpQRJ4QSJ4QSJ4QSJ4QSJ4RylEKMbdu2jdzefPPN8toPPvig3Hfs2FHuZ8+eLffzyVEKTBlxQihxQihxQihxQihxQihxQijnnEyF559/vtz37dtX7vPz8+U+7lvSzifnnDBlxAmhxAmhxAmhxAmhxAmhxAmhNk76BuCnOH369KRv4YLz5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQU3vOOTc3V+4X47nYpG3cWP90uv7668v9rrvuGrk99NBD5bXjXtd2kt+vuVaenBBKnBBKnBBKnBBKnBBKnBAq9qUxr7zyynI/ceJEue/fv3/kdujQofLab775ptyXl5fLPdnmzZvLvfrvvmvXrvLa++67r9xvvvnmcn/vvfdGbq+++mp57cGDB8v9888/L/dJ8tKYMGXECaHECaHECaHECaHECaHECaFizzk3bKi/brz00kvlvnfv3jV/7pWVlXIfd865tLRU7idPnhy57dixo7x23DnlOAsLC+V+1VVXjdyqnys/xbi38XvggQfW9fGnlXNOmDLihFDihFDihFDihFDihFDihFCx55zjjDsH3blz55q21lrbtm1buY97Wc4bbrih3Kuzyt5XPfL60bFjx8p9vS8B+frrr4/cxp1zHj58uNw//fTTcl/vOeq0cs4JU0acEEqcEEqcEEqcEEqcEEqcEGpqzzlhVjjnhCkjTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTghVvgUgMDmenBBKnBBKnBBKnBBKnBBKnBDqPw36mCmnZW+WAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAHmElEQVR4nO3dQYhd1QHG8XM0wUEqI2iyGldZWA1SkYAkQmgYmaJZuFAxWRlCQSMiKONKENwInWUJVajgJsigRVDGuBk7IRSzCDGbBEspQhbqRgkJWpXEuV20Loq5Z8x7M33fe/P7QRbJx517IfzzEo/vTe26rgB5bhj1AwDXJk4IJU4IJU4IJU4IJU4IJU4IJc4JUWs9Vmv9stZ6udb6j1rr70f9TAyn+p8QJkOtdWcp5Z9d1/1Qa/11KeVEKWV/13VnRvtkDMor54Touu5813U//PTT//7YMcJHYkjinCC11j/VWv9VSvl7KeXLUsrxET8SQ/DX2glTa72xlLK7lPLbUsofuq67MtonYlBeOSdM13U/dl33t1LKTCnlyKifh8GJc3JtKf7NOdbEOQFqrdtrrQdqrb+qtd5Ya/1dKeVgKeWvo342BuffnBOg1rqtlPKXUspvyn/+wL1QSvlj13V/HumDMRRxQih/rYVQ4oRQ4oRQ4oRQW1pjrdV/LYIN1nVdvdave+WEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUM1vAcj42b59e3N/7rnnmvtLL73Uuy0vLzevffjhh5v7lStXmjv/yysnhBInhBInhBInhBInhBInhBInhKpd1/WPtfaPbIgnnniiud98883N/emnn27uu3btuu5n+qUefPDB5r6ysrJh9x5nXdfVa/26V04IJU4IJU4IJU4IJU4IJU4IJU4I5f2cG+DOO+9s7ocOHerdXnjhhea1W7bk/pbdc889zd055/XxygmhxAmhxAmhxAmhxAmhxAmhvGVsAPPz88392Wefbe533HHHwPe+dOnSwNeWUsr09PTA137++efNfa0jpO+++27ge08ybxmDMSNOCCVOCCVOCCVOCCVOCCVOCJX7/qNgt956a3Mf5hzzvffea+6vvfZac3/55Zeb+549e677mX7y5ptvNnfnmOvLKyeEEieEEieEEieEEieEEieEEieEcs45gFdeeaW533XXXc19eXm5d3vrrbea1y4sLDT3Yc4xSynl22+/7d2WlpaG+tpcH6+cEEqcEEqcEEqcEEqcEEqcEEqcEMrn1o7A7t27e7cXX3yxee0jjzwy1L0vX77c3Ofm5nq306dPD3Vvrs3n1sKYESeEEieEEieEEieEEieEEieEcs45Aq33TE5NTW3ovZ988snmfuzYsQ29Pz/nnBPGjDghlDghlDghlDghlDghlKOUEfj+++97t61bt27ovS9evNjcFxcXe7ePP/64ee3bb7/d3K9evdrcNytHKTBmxAmhxAmhxAmhxAmhxAmhxAmhnHOOwCjPOTfSuXPnmvurr77a3D/77LPebZI/ltM5J4wZcUIocUIocUIocUIocUIocUIo55wjMDs727vt37+/ee3x48eHuvfBgweb+7333jvw17799tub+8zMTHM/efJk77Zv376BnmkcOOeEMSNOCCVOCCVOCCVOCCVOCCVOCOWck3WzY8eO5r7WGe309HTv9tBDDzWvPXv2bHNP5pwTxow4IZQ4IZQ4IZQ4IZQ4IZQ4IdSmPOes9ZrHSr94X11dXc/H2TQeffTR5t76/p5vvPFG89qnnnpqoGdK4JwTxow4IZQ4IZQ4IZQ4IZQ4IdSWUT/ARjly5Ejvtm3btua177zzTnP/9NNPB3qmza71kaBreeCBB9bxScaDV04IJU4IJU4IJU4IJU4IJU4IJU4INbFvGTt//nzvdunSpea1e/bsWe/H2RTuvvvu5n7ixInmftttt/Vujz/+ePPad999t7kn85YxGDPihFDihFDihFDihFDihFDihFBj+37Oxx57rLm3vh3dJ598st6PMzFuuKH/z+ujR482r13r96R1jllKKV999VXvduHChea1k8grJ4QSJ4QSJ4QSJ4QSJ4QSJ4QSJ4Qa23POtd4b+MUXX/RuO3fubF77wQcfNPeFhYXmvpaTJ0/2bvfff3/z2ptuummoex84cKC533fffb3brl27hrr3WpaWlnq3M2fObOi9E3nlhFDihFDihFDihFDihFDihFAT+9GYKysrvdvevXv/j0/ycx9++GHvtm/fvua1U1NT6/046+bixYvN/fnnn2/u77//fu+21seZjjMfjQljRpwQSpwQSpwQSpwQSpwQSpwQamLPOWdmZnq3w4cPN6995plnmvstt9zS3JPPIldXV5v7119/3bt99NFHzWvX+ujMU6dONffNyjknjBlxQihxQihxQihxQihxQihxQqiJPefcSHNzc819fn6+uc/OzvZuZ8+ebV67uLjY3NfyzTffNPfXX399qK/P9XPOCWNGnBBKnBBKnBBKnBBKnBBKnBDKOSeMmHNOGDPihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDNbwEIjI5XTgglTgglTgglTgglTgglTgj1b38zgsw0F0XIAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#Lose type of tensors (to emulate predictions)</span>
<span class="n">test_ne</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Check that types are put back by dl.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAHC0lEQVR4nO3du4tV3R3H4bW8YGFAFJMpDE5hYSCC2hlQvBSOEBhshKTVIETRxtu/YLAb8C3GwlHSmamENEIIOpZBLAJj0AFFebERtIho0J0iFwjMWSfO5T3fc+Z5wML5sd2r+cweXa6za9d1BcizbtALABYnTgglTgglTgglTgglTgglTgglzhFRa/19rfX7WuuHWuvfaq2/GfSaWJ7qPyGMhlrrz0spz7uu+1Rr/Vkp5c+llF92XfeXwa6MpfLkHBFd1/2167pP//ntv3/tGuCSWCZxjpBa63e11r+XUuZLKd+XUv444CWxDH6sHTG11vWllF+UUo6UUn7Xdd0/BrsilsqTc8R0Xfel67q5UspPSym/HfR6WDpxjq4Nxd85h5o4R0Ct9Se11l/VWn9Ua11fa50opfy6lPKnQa+NpfN3zhFQa/1xKeUPpZS95V/fcF+WUqa6rrs10IWxLOKEUH6shVDihFDihFDihFAbWsNaq38tglXWdV1d7OuenBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBBKnBCq+QrAUTU2Ntac37t3rzk/dOhQcz49Pd2cb9++vefs/v37zWv7mZmZWdb15PDkhFDihFDihFDihFDihFDihFDihFC167rew1p7D4fYkSNHmvMHDx405+vWtb+nff369VuXtGLm5uaa8+vXrzfn8/PzPWevX79uXvvly5fmnMV1XVcX+7onJ4QSJ4QSJ4QSJ4QSJ4QSJ4QSJ4Rak/uc4+Pjzfns7Gxzvn///uZ8kPucq7kHe+nSpeZ8ampqyX/2WmafE4aMOCGUOCGUOCGUOCGUOCHUmtxK6Wfbtm3Neb+Pzty7d29zvmXLlm9e0/9rNbdSPn361Jy/ffu2OT9z5kxz/uTJk56z9+/fN68dZrZSYMiIE0KJE0KJE0KJE0KJE0KJE0LZ51wFExMTzfnZs2d7ziYnJ5d17+SP7ey3tqNHj/acPXz4cKWXE8M+JwwZcUIocUIocUIocUIocUIocUIo+5wj5uDBg8356dOnm/N9+/b1nPU7p9pPv33OhYWFnrNdu3Yt697J7HPCkBEnhBInhBInhBInhBInhBInhLLPucaMjY0159euXes5u3DhwrLu3W+f8+PHjz1n58+fb157586dJa0pgX1OGDLihFDihFDihFDihFDihFDihFAbBr0AVlbrPGYppczOzjbnO3fuXMnlfJNNmzb1nI2Pj/+AK8ngyQmhxAmhxAmhxAmhxAmhxAmhHBkLc+DAgeb83LlzzfmJEyea861bt37zmlZKvyNjr1696jnr97GcHz58WNKaEjgyBkNGnBBKnBBKnBBKnBBKnBBKnBDKkbEBOHnyZM/ZzMxM89rNmzc35/32Er9+/dqcD9L09HTP2TDvYy6VJyeEEieEEieEEieEEieEEieEEieEcp5zFfT7GMeFhYVVu/cg9znn5uaa88OHD6/avYeZ85wwZMQJocQJocQJocQJocQJocQJoZznHIBBnqn8/Plzc/7mzZuesytXrjSvffz48ZLWxOI8OSGUOCGUOCGUOCGUOCGUOCGUOCGUfc415ubNm8355cuXf6CV0I8nJ4QSJ4QSJ4QSJ4QSJ4QSJ4SylbIKXr9+3ZxPTU31nF28eHGll/M/Xr161Zy3Ptbz5cuXK70cGjw5IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZRXAA7Avn37es5OnTrVvPbq1avN+XJfAfj06dOes+PHjzevfffuXXPO4rwCEIaMOCGUOCGUOCGUOCGUOCGUOCHU0J7nbJ07LKWUhYWFnrN+r7Ib5H5drYtuef1Xv33MfvN+9u/f33P26NGj5rWTk5PN+YsXL5a0prXKkxNCiRNCiRNCiRNCiRNCiRNCiRNCDe15zn77nM+fP1+1ey/3zORqGuTanj171pzv2bNn1e49zJznhCEjTgglTgglTgglTgglTgg1tEfGyLN79+5BL2GkeHJCKHFCKHFCKHFCKHFCKHFCKHFCqKE9MrZ+/frmfMeOHT1nt27dal577Nix5tyRsaXZuHHjwO6dzJExGDLihFDihFDihFDihFDihFDihFBDu8+5HGNjY835xMREc3779u3mfFT3Oefn55vzGzduNOd3795d8r1HmX1OGDLihFDihFDihFDihFDihFDihFBrcp8TktjnhCEjTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgjVfAUgMDienBBKnBBKnBBKnBBKnBBKnBDqn6UCbXpskcm1AAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAH5klEQVR4nO3dT4hd5R3G8feNEVyMfyJMJ4vipqLFLIJIEgsJlATsooi4CLYqohCQCi5EUMSFiAvJxkXBioQslOJC60KEZmNiIIMLISjIaKhRKYoOIhGHUJHYnC5ahcDc39WZJve5N58PuDAPZ+ag+c5J8mbu7cMwNCDPhknfALA6cUIocUIocUIocUIocUIocUIocc6I3vtfe+9f9N5Xeu//6L3vm/Q9sT7dX0KYDb33La21k8MwfNd7/3Vr7Whr7ffDMByf7J2xVp6cM2IYhqVhGL774V//98+vJnhLrJM4Z0jv/S+993+11k601r5orf19wrfEOvhl7YzpvV/SWvtNa+23rbX9wzCcmewdsVaenDNmGIZ/D8Ow2Fr7ZWvtT5O+H9ZOnLNrY/N7zqkmzhnQe/9F7/0Pvfe53vslvffftdb+2Fo7Mul7Y+38nnMG9N7nW2t/a61tbf/9gvvP1tqfh2E4MNEbY13ECaH8shZCiRNCiRNCiRNCbazG3rs/LYLzbBiGvtqPe3JCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCqPItAGfVnj17yn3Xrl3lvnPnznLfvXv3z76nH/S+6rvB/WgY1veujIcOHSr3t956a+T28ssvl9d+9NFH5X727Nly51yenBBKnBBKnBBKnBBKnBBKnBBKnBCqV+dmvff1HapN0D333DNyO3DgQHnthg3116x33nmn3I8cOVLu77777sht3Dnn1q1by32czZs3l/stt9wycltYWCivPXz4cLnfeeed5f7VV1+V+6wahmHV/+menBBKnBBKnBBKnBBKnBBKnBBKnBBqas855+fny/39999f09Zaa48//ni5Ly4ulvs0u+KKK0Zue/fuLa99+OGHy/3bb78t95tuuqncZ5VzTpgy4oRQ4oRQ4oRQ4oRQ4oRQU/vSmONe3rJy++23l/upU6fW/LGn3crKysjt4MGD5bUff/xxub/xxhvlfuONN47cxn2b3izy5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQU3vOefTo0XJ/5plnRm4X8znm+XTs2LFy//rrr8v9mmuuGbk55wRiiBNCiRNCiRNCiRNCiRNCiRNCTe055/Lycrk//fTTF+hO+MH9999f7ps2bSr3Dz/88P95O1PPkxNCiRNCiRNCiRNCiRNCiRNCiRNCTe05JxfeI488Uu5PPvlkub/22mvlPu6tGS82npwQSpwQSpwQSpwQSpwQSpwQSpwQyjnnRaZ6D8zWWnvxxRdHbtddd1157XPPPVfujz76aLlzLk9OCCVOCCVOCCVOCCVOCCVOCOUoZRW993K/+uqry33Lli3lfu21147ctm/fXl67sLBQ7nv27Cn3ubm5cl9aWhq53X333eW1r7zySrnz83hyQihxQihxQihxQihxQihxQihxQijnnKsYd4755ZdfnrfPPe6MdRiGdX38cdd///33I7fPPvusvPbSSy8t9zNnzpQ75/LkhFDihFDihFDihFDihFDihFDihFC9Ovfqva/vUG1KXXbZZeX+4IMPnrfP/fbbb5f76dOny3337t3lPu77Qe+9996R26ZNm8prP/nkk3J/6qmnyv2FF14o91k1DMOqh9uenBBKnBBKnBBKnBBKnBBKnBBKnBDKOSfnuPzyy0dut912W3nts88+W+7jXjN3eXl55HbHHXeU1y4uLpZ7MuecMGXECaHECaHECaHECaHECaHECaGcc3LBPPbYY+X+xBNPjNxOnTpVXnvrrbeW+/Hjx8t9kpxzwpQRJ4QSJ4QSJ4QSJ4QSJ4RylEKMbdu2jdzefPPN8toPPvig3Hfs2FHuZ8+eLffzyVEKTBlxQihxQihxQihxQihxQihxQijnnEyF559/vtz37dtX7vPz8+U+7lvSzifnnDBlxAmhxAmhxAmhxAmhxAmhxAmhNk76BuCnOH369KRv4YLz5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQU3vOOTc3V+4X47nYpG3cWP90uv7668v9rrvuGrk99NBD5bXjXtd2kt+vuVaenBBKnBBKnBBKnBBKnBBKnBAq9qUxr7zyynI/ceJEue/fv3/kdujQofLab775ptyXl5fLPdnmzZvLvfrvvmvXrvLa++67r9xvvvnmcn/vvfdGbq+++mp57cGDB8v9888/L/dJ8tKYMGXECaHECaHECaHECaHECaHECaFizzk3bKi/brz00kvlvnfv3jV/7pWVlXIfd865tLRU7idPnhy57dixo7x23DnlOAsLC+V+1VVXjdyqnys/xbi38XvggQfW9fGnlXNOmDLihFDihFDihFDihFDihFDihFCx55zjjDsH3blz55q21lrbtm1buY97Wc4bbrih3Kuzyt5XPfL60bFjx8p9vS8B+frrr4/cxp1zHj58uNw//fTTcl/vOeq0cs4JU0acEEqcEEqcEEqcEEqcEEqcEGpqzzlhVjjnhCkjTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTgglTghVvgUgMDmenBBKnBBKnBBKnBBKnBBKnBDqPw36mCmnZW+WAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAHmElEQVR4nO3dQYhd1QHG8XM0wUEqI2iyGldZWA1SkYAkQmgYmaJZuFAxWRlCQSMiKONKENwInWUJVajgJsigRVDGuBk7IRSzCDGbBEspQhbqRgkJWpXEuV20Loq5Z8x7M33fe/P7QRbJx517IfzzEo/vTe26rgB5bhj1AwDXJk4IJU4IJU4IJU4IJU4IJU4IJc4JUWs9Vmv9stZ6udb6j1rr70f9TAyn+p8QJkOtdWcp5Z9d1/1Qa/11KeVEKWV/13VnRvtkDMor54Touu5813U//PTT//7YMcJHYkjinCC11j/VWv9VSvl7KeXLUsrxET8SQ/DX2glTa72xlLK7lPLbUsofuq67MtonYlBeOSdM13U/dl33t1LKTCnlyKifh8GJc3JtKf7NOdbEOQFqrdtrrQdqrb+qtd5Ya/1dKeVgKeWvo342BuffnBOg1rqtlPKXUspvyn/+wL1QSvlj13V/HumDMRRxQih/rYVQ4oRQ4oRQ4oRQW1pjrdV/LYIN1nVdvdave+WEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUOKEUM1vAcj42b59e3N/7rnnmvtLL73Uuy0vLzevffjhh5v7lStXmjv/yysnhBInhBInhBInhBInhBInhBInhKpd1/WPtfaPbIgnnniiud98883N/emnn27uu3btuu5n+qUefPDB5r6ysrJh9x5nXdfVa/26V04IJU4IJU4IJU4IJU4IJU4IJU4I5f2cG+DOO+9s7ocOHerdXnjhhea1W7bk/pbdc889zd055/XxygmhxAmhxAmhxAmhxAmhxAmhvGVsAPPz88392Wefbe533HHHwPe+dOnSwNeWUsr09PTA137++efNfa0jpO+++27ge08ybxmDMSNOCCVOCCVOCCVOCCVOCCVOCJX7/qNgt956a3Mf5hzzvffea+6vvfZac3/55Zeb+549e677mX7y5ptvNnfnmOvLKyeEEieEEieEEieEEieEEieEEieEcs45gFdeeaW533XXXc19eXm5d3vrrbea1y4sLDT3Yc4xSynl22+/7d2WlpaG+tpcH6+cEEqcEEqcEEqcEEqcEEqcEEqcEMrn1o7A7t27e7cXX3yxee0jjzwy1L0vX77c3Ofm5nq306dPD3Vvrs3n1sKYESeEEieEEieEEieEEieEEieEcs45Aq33TE5NTW3ovZ988snmfuzYsQ29Pz/nnBPGjDghlDghlDghlDghlDghlKOUEfj+++97t61bt27ovS9evNjcFxcXe7ePP/64ee3bb7/d3K9evdrcNytHKTBmxAmhxAmhxAmhxAmhxAmhxAmhnHOOwCjPOTfSuXPnmvurr77a3D/77LPebZI/ltM5J4wZcUIocUIocUIocUIocUIocUIo55wjMDs727vt37+/ee3x48eHuvfBgweb+7333jvw17799tub+8zMTHM/efJk77Zv376BnmkcOOeEMSNOCCVOCCVOCCVOCCVOCCVOCOWck3WzY8eO5r7WGe309HTv9tBDDzWvPXv2bHNP5pwTxow4IZQ4IZQ4IZQ4IZQ4IZQ4IdSmPOes9ZrHSr94X11dXc/H2TQeffTR5t76/p5vvPFG89qnnnpqoGdK4JwTxow4IZQ4IZQ4IZQ4IZQ4IdSWUT/ARjly5Ejvtm3btua177zzTnP/9NNPB3qmza71kaBreeCBB9bxScaDV04IJU4IJU4IJU4IJU4IJU4IJU4INbFvGTt//nzvdunSpea1e/bsWe/H2RTuvvvu5n7ixInmftttt/Vujz/+ePPad999t7kn85YxGDPihFDihFDihFDihFDihFDihFBj+37Oxx57rLm3vh3dJ598st6PMzFuuKH/z+ujR482r13r96R1jllKKV999VXvduHChea1k8grJ4QSJ4QSJ4QSJ4QSJ4QSJ4QSJ4Qa23POtd4b+MUXX/RuO3fubF77wQcfNPeFhYXmvpaTJ0/2bvfff3/z2ptuummoex84cKC533fffb3brl27hrr3WpaWlnq3M2fObOi9E3nlhFDihFDihFDihFDihFDihFAT+9GYKysrvdvevXv/j0/ycx9++GHvtm/fvua1U1NT6/046+bixYvN/fnnn2/u77//fu+21seZjjMfjQljRpwQSpwQSpwQSpwQSpwQSpwQamLPOWdmZnq3w4cPN6995plnmvstt9zS3JPPIldXV5v7119/3bt99NFHzWvX+ujMU6dONffNyjknjBlxQihxQihxQihxQihxQihxQqiJPefcSHNzc819fn6+uc/OzvZuZ8+ebV67uLjY3NfyzTffNPfXX399qK/P9XPOCWNGnBBKnBBKnBBKnBBKnBBKnBDKOSeMmHNOGDPihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDihFDNbwEIjI5XTgglTgglTgglTgglTgglTgj1b38zgsw0F0XIAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#TODO: make the above check a proper test</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

